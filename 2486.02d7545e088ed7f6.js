"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2486],{2486:(qt,R,h)=>{h.r(R),h.d(R,{HomePageModule:()=>Zt});var k=h(2200),x=h(4341),p=h(9893),O=h(8132),f=h(467);const B={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let T;const J=new Uint8Array(16),g=[];for(let i=0;i<256;++i)g.push((i+256).toString(16).slice(1));function Z(i,n,o){const e=(i=i||{}).random??i.rng?.()??function Q(){if(!T){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");T=crypto.getRandomValues.bind(crypto)}return T(J)}();if(e.length<16)throw new Error("Random bytes length must be >= 16");if(e[6]=15&e[6]|64,e[8]=63&e[8]|128,n){if((o=o||0)<0||o+16>n.length)throw new RangeError(`UUID byte range ${o}:${o+15} is out of buffer bounds`);for(let s=0;s<16;++s)n[o+s]=e[s];return n}return function S(i,n=0){return(g[i[n+0]]+g[i[n+1]]+g[i[n+2]]+g[i[n+3]]+"-"+g[i[n+4]]+g[i[n+5]]+"-"+g[i[n+6]]+g[i[n+7]]+"-"+g[i[n+8]]+g[i[n+9]]+"-"+g[i[n+10]]+g[i[n+11]]+g[i[n+12]]+g[i[n+13]]+g[i[n+14]]+g[i[n+15]]).toLowerCase()}(e)}var et=h(9974),nt=h(4360),t=h(3664),d=h(2615),G=h(9330),ot=h(9350),st=h(7707);function I(i,n){const o="object"==typeof n;return new Promise((e,s)=>{const r=new st.Ms({next:a=>{e(a),r.unsubscribe()},error:s,complete:()=>{o?e(n.defaultValue):s(new ot.G)}});i.subscribe(r)})}var rt=h(1985),at=h(8359);class ct extends at.yU{constructor(n,o){super()}schedule(n,o=0){return this}}const w={setInterval(i,n,...o){const{delegate:e}=w;return e?.setInterval?e.setInterval(i,n,...o):setInterval(i,n,...o)},clearInterval(i){const{delegate:n}=w;return(n?.clearInterval||clearInterval)(i)},delegate:void 0};var lt=h(7908);const $={now:()=>($.delegate||Date).now(),delegate:void 0};class b{constructor(n,o=b.now){this.schedulerActionCtor=n,this.now=o}schedule(n,o=0,e){return new this.schedulerActionCtor(this,n).schedule(e,o)}}b.now=$.now;const pt=new class dt extends b{constructor(n,o=b.now){super(n,o),this.actions=[],this._active=!1}flush(n){const{actions:o}=this;if(this._active)return void o.push(n);let e;this._active=!0;do{if(e=n.execute(n.state,n.delay))break}while(n=o.shift());if(this._active=!1,e){for(;n=o.shift();)n.unsubscribe();throw e}}}(class ut extends ct{constructor(n,o){super(n,o),this.scheduler=n,this.work=o,this.pending=!1}schedule(n,o=0){var e;if(this.closed)return this;this.state=n;const s=this.id,r=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(r,s,o)),this.pending=!0,this.delay=o,this.id=null!==(e=this.id)&&void 0!==e?e:this.requestAsyncId(r,this.id,o),this}requestAsyncId(n,o,e=0){return w.setInterval(n.flush.bind(n,this),e)}recycleAsyncId(n,o,e=0){if(null!=e&&this.delay===e&&!1===this.pending)return o;null!=o&&w.clearInterval(o)}execute(n,o){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const e=this._execute(n,o);if(e)return e;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,o){let s,e=!1;try{this.work(n)}catch(r){e=!0,s=r||new Error("Scheduled action threw falsy error")}if(e)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:n,scheduler:o}=this,{actions:e}=o;this.work=this.state=this.scheduler=null,this.pending=!1,(0,lt.o)(e,this),null!=n&&(this.id=this.recycleAsyncId(o,n,null)),this.delay=null,super.unsubscribe()}}});var ft=h(9470);var mt=h(5558);let _t=(()=>{var i;class n{constructor(e){this.http=e,this.apiBase="https://api.arting.ai/api",this.auth="150afc00-5f9e-489b-973c-802e2c67446b"}getSignedUrl(e){var s=this;return(0,f.A)(function*(){return I(s.http.post(`${s.apiBase}/cg/get_oss_signed_urls`,{f_suffixs:[e]}))})()}uploadToOss(e,s,r){var a=this;return(0,f.A)(function*(){const c=new G.Lr({"Content-Type":r});return I(a.http.put(e,s,{headers:c}))})()}initSwap(e,s,r,a,c){var l=this;return(0,f.A)(function*(){const u={authorization:a};return I("image"===e?l.http.post(`${l.apiBase}/fs/singleface`,{target_image_file:r,target_face_file:s,face_enhance:!1},{headers:u}):l.http.post(`${l.apiBase}/fs/gifvideo/mutilface`,{task_type:2,file_type:e,target_medio_url:r,target_source_face_url:s,duration:100,start_clip_sec:0,end_clip_sec:100,face_enhance:c},{headers:u}))})()}pollStatus(e,s,r){const a={authorization:r};return function gt(i=0,n,o=pt){let e=-1;return null!=n&&((0,ft.m)(n)?o=n:e=n),new rt.c(s=>{let r=function ht(i){return i instanceof Date&&!isNaN(i)}(i)?+i-o.now():i;r<0&&(r=0);let a=0;return o.schedule(function(){s.closed||(s.next(a++),0<=e?this.schedule(void 0,e):s.complete())},r)})}(0,"image"===e?5e3:1e4).pipe((0,mt.n)(()=>{if("image"===e)return this.http.get(`${this.apiBase}/fs/result?request_id=${s}`,{headers:a});{const l=new FormData;return l.append("prediction_id",s),l.append("task_type","2"),this.http.post(`${this.apiBase}/mfs/gifvideo/task/status`,l,{headers:a})}}))}static#t=i=()=>(this.\u0275fac=function(s){return new(s||n)(d.KVO(G.Qq))},this.\u0275prov=d.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}))}return i(),n})();function H(i,n){this.v=i,this.k=n}function V(i){return new H(i,0)}function v(i){var n,o;function e(r,a){try{var c=i[r](a),l=c.value,u=l instanceof H;Promise.resolve(u?l.v:l).then(function(m){if(u){var y="return"===r?"return":"next";if(!l.k||m.done)return e(y,m);m=i[y](m).value}s(c.done?"return":"normal",m)},function(m){e("throw",m)})}catch(m){s("throw",m)}}function s(r,a){switch(r){case"return":n.resolve({value:a,done:!0});break;case"throw":n.reject(a);break;default:n.resolve({value:a,done:!1})}(n=n.next)?e(n.key,n.arg):o=null}this._invoke=function(r,a){return new Promise(function(c,l){var u={key:r,arg:a,resolve:c,reject:l,next:null};o?o=o.next=u:(n=o=u,e(r,a))})},"function"!=typeof i.return&&(this.return=void 0)}v.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},v.prototype.next=function(i){return this._invoke("next",i)},v.prototype.throw=function(i){return this._invoke("throw",i)},v.prototype.return=function(i){return this._invoke("return",i)};const j=(i,n)=>n.some(o=>i instanceof o);let L,Y;const A=new WeakMap,E=new WeakMap,P=new WeakMap;let C={get(i,n,o){if(i instanceof IDBTransaction){if("done"===n)return A.get(i);if("store"===n)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return _(i[n])},set:(i,n,o)=>(i[n]=o,!0),has:(i,n)=>i instanceof IDBTransaction&&("done"===n||"store"===n)||n in i};function N(i){C=i(C)}function Pt(i){return"function"==typeof i?function wt(i){return function vt(){return Y||(Y=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(i)?function(...n){return i.apply(M(this),n),_(this.request)}:function(...n){return _(i.apply(M(this),n))}}(i):(i instanceof IDBTransaction&&function It(i){if(A.has(i))return;const n=new Promise((o,e)=>{const s=()=>{i.removeEventListener("complete",r),i.removeEventListener("error",a),i.removeEventListener("abort",a)},r=()=>{o(),s()},a=()=>{e(i.error||new DOMException("AbortError","AbortError")),s()};i.addEventListener("complete",r),i.addEventListener("error",a),i.addEventListener("abort",a)});A.set(i,n)}(i),j(i,function bt(){return L||(L=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(i,C):i)}function _(i){if(i instanceof IDBRequest)return function kt(i){const n=new Promise((o,e)=>{const s=()=>{i.removeEventListener("success",r),i.removeEventListener("error",a)},r=()=>{o(_(i.result)),s()},a=()=>{e(i.error),s()};i.addEventListener("success",r),i.addEventListener("error",a)});return P.set(n,i),n}(i);if(E.has(i))return E.get(i);const n=Pt(i);return n!==i&&(E.set(i,n),P.set(n,i)),n}const M=i=>P.get(i),Tt=["get","getKey","getAll","getAllKeys","count"],jt=["put","add","delete","clear"],D=new Map;function z(i,n){if(!(i instanceof IDBDatabase)||n in i||"string"!=typeof n)return;if(D.get(n))return D.get(n);const o=n.replace(/FromIndex$/,""),e=n!==o,s=jt.includes(o);if(!(o in(e?IDBIndex:IDBObjectStore).prototype)||!s&&!Tt.includes(o))return;const r=function(){var a=(0,f.A)(function*(c,...l){const u=this.transaction(c,s?"readwrite":"readonly");let m=u.store;return e&&(m=m.index(l.shift())),(yield Promise.all([m[o](...l),s&&u.done]))[0]});return function(l){return a.apply(this,arguments)}}();return D.set(n,r),r}N(i=>({...i,get:(n,o,e)=>z(n,o)||i.get(n,o,e),has:(n,o)=>!!z(n,o)||i.has(n,o)}));const At=["continue","continuePrimaryKey","advance"],X={},U=new WeakMap,W=new WeakMap,Et={get(i,n){if(!At.includes(n))return i[n];let o=X[n];return o||(o=X[n]=function(...e){U.set(this,W.get(this)[n](...e))}),o}};function Ct(){return F.apply(this,arguments)}function F(){return F=function yt(i){return function(){return new v(i.apply(this,arguments))}}(function*(...i){let n=this;if(n instanceof IDBCursor||(n=yield V(n.openCursor(...i))),!n)return;const o=new Proxy(n,Et);for(W.set(o,n),P.set(o,M(n));n;)yield o,n=yield V(U.get(o)||n.continue()),U.delete(o)}),F.apply(this,arguments)}function K(i,n){return n===Symbol.asyncIterator&&j(i,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===n&&j(i,[IDBIndex,IDBObjectStore])}N(i=>({...i,get:(n,o,e)=>K(n,o)?Ct:i.get(n,o,e),has:(n,o)=>K(n,o)||i.has(n,o)}));let Mt=(()=>{var i;class n{constructor(){this.dbPromise=function xt(i,n,{blocked:o,upgrade:e,blocking:s,terminated:r}={}){const a=indexedDB.open(i,n),c=_(a);return e&&a.addEventListener("upgradeneeded",l=>{e(_(a.result),l.oldVersion,l.newVersion,_(a.transaction),l)}),o&&a.addEventListener("blocked",l=>o(l.oldVersion,l.newVersion,l)),c.then(l=>{r&&l.addEventListener("close",()=>r()),s&&l.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),c}("FaceSwapDB11",11,{upgrade(e){e.createObjectStore("faces"),e.createObjectStore("targets"),e.createObjectStore("tasks")}})}set(e,s,r){var a=this;return(0,f.A)(function*(){return(yield a.dbPromise).put(e,r,s)})()}getAll(e){var s=this;return(0,f.A)(function*(){return(yield s.dbPromise).getAll(e)})()}delete(e,s){var r=this;return(0,f.A)(function*(){return(yield r.dbPromise).delete(e,s)})()}clearStore(e){var s=this;return(0,f.A)(function*(){return(yield s.dbPromise).clear(e)})()}clearAll(){var e=this;return(0,f.A)(function*(){yield e.clearStore("faces"),yield e.clearStore("targets"),yield e.clearStore("tasks")})()}static#t=i=()=>(this.\u0275fac=function(s){return new(s||n)},this.\u0275prov=d.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}))}return i(),n})();function Dt(i,n){1&i&&(t.j41(0,"div",29),t.nrm(1,"ion-icon",30),t.k0s())}function Ut(i,n){1&i&&t.nrm(0,"ion-spinner",31)}function Ft(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-col",22)(1,"div",23)(2,"ion-button",24),t.bIt("click",function(){const s=d.eBV(o).$implicit,r=t.XpG();return d.Njj(r.removeMedia(s.id,"faces"))}),t.nrm(3,"ion-icon",25),t.k0s(),t.nrm(4,"img",26),t.DNE(5,Dt,2,0,"div",27)(6,Ut,1,0,"ion-spinner",28),t.k0s()()}if(2&i){const o=n.$implicit;t.R7$(),t.AVh("upload-success","success"===o.status),t.R7$(3),t.Y8G("src",o.localUrl,t.B4B),t.R7$(),t.Y8G("ngIf","success"===o.status),t.R7$(),t.Y8G("ngIf","uploading"===o.status)}}function Rt(i,n){if(1&i&&t.nrm(0,"img",26),2&i){const o=t.XpG().$implicit;t.Y8G("src",o.localUrl,t.B4B)}}function Ot(i,n){if(1&i&&t.nrm(0,"video",37),2&i){const o=t.XpG().$implicit;t.Y8G("src",o.localUrl,t.B4B)}}function Bt(i,n){1&i&&(t.j41(0,"div",29),t.nrm(1,"ion-icon",30),t.k0s())}function St(i,n){1&i&&t.nrm(0,"ion-spinner",38)}function Gt(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-col",32)(1,"div",23)(2,"ion-button",33),t.bIt("click",function(){const s=d.eBV(o).$implicit,r=t.XpG();return d.Njj(r.removeMedia(s.id,"targets"))}),t.nrm(3,"ion-icon",25),t.k0s(),t.DNE(4,Rt,1,1,"img",34)(5,Ot,1,1,"video",35)(6,Bt,2,0,"div",27)(7,St,1,0,"ion-spinner",36),t.k0s()()}if(2&i){const o=n.$implicit;t.R7$(),t.AVh("upload-success","success"===o.status),t.R7$(3),t.Y8G("ngIf","video"!==o.type),t.R7$(),t.Y8G("ngIf","video"===o.type),t.R7$(),t.Y8G("ngIf","success"===o.status),t.R7$(),t.Y8G("ngIf","uploading"===o.status)}}function $t(i,n){if(1&i&&(t.j41(0,"span"),t.EFF(1),t.k0s()),2&i){const o=t.XpG();t.R7$(),t.SpI(" Start Swap (",o.faces.length*o.targets.length," combinations)\n")}}function Ht(i,n){1&i&&(t.j41(0,"span"),t.EFF(1," All Tasks Processing...\n"),t.k0s())}function Vt(i,n){1&i&&(t.j41(0,"span"),t.EFF(1," Upload Media First\n"),t.k0s())}function Lt(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-button",39),t.bIt("click",function(){d.eBV(o);const s=t.XpG();return d.Njj(s.downloadAllTasks())}),t.nrm(1,"ion-icon",40),t.EFF(2," Download All "),t.k0s()}}function Yt(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-button",41),t.bIt("click",function(){d.eBV(o);const s=t.XpG();return d.Njj(s.clearAllTasks())}),t.nrm(1,"ion-icon",42),t.k0s()}}function Nt(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-button",52),t.bIt("click",function(){d.eBV(o);const s=t.XpG().$implicit,r=t.XpG();return d.Njj(r.retryTask(s))}),t.nrm(1,"ion-icon",53),t.k0s()}}function zt(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-button",54),t.bIt("click",function(){d.eBV(o);const s=t.XpG().$implicit,r=t.XpG();return d.Njj(r.directDownload(s))}),t.nrm(1,"ion-icon",55),t.k0s()}}function Xt(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-button",56),t.bIt("click",function(){d.eBV(o);const s=t.XpG().$implicit,r=t.XpG();return d.Njj(r.openUrl(s.outputUrl))}),t.nrm(1,"ion-icon",57),t.k0s()}}function Wt(i,n){1&i&&t.nrm(0,"ion-spinner",58)}function Kt(i,n){if(1&i){const o=t.RV6();t.j41(0,"ion-item")(1,"ion-thumbnail",43),t.nrm(2,"img",26),t.k0s(),t.j41(3,"ion-label")(4,"h3"),t.EFF(5),t.nI1(6,"uppercase"),t.k0s(),t.j41(7,"p"),t.EFF(8,"Status: "),t.j41(9,"ion-badge",44),t.EFF(10),t.k0s()()(),t.j41(11,"div",45),t.DNE(12,Nt,2,0,"ion-button",46)(13,zt,2,0,"ion-button",47)(14,Xt,2,0,"ion-button",48),t.j41(15,"ion-button",49),t.bIt("click",function(){const s=d.eBV(o).$implicit,r=t.XpG();return d.Njj(r.deleteSingleTask(s.id))}),t.nrm(16,"ion-icon",50),t.k0s(),t.DNE(17,Wt,1,0,"ion-spinner",51),t.k0s()()}if(2&i){const o=n.$implicit;t.R7$(2),t.Y8G("src",o.faceUrl,t.B4B),t.R7$(3),t.SpI("Type: ",t.bMT(6,8,o.type)),t.R7$(4),t.Y8G("color","success"===o.status?"success":"warning"),t.R7$(),t.JRh(o.status),t.R7$(2),t.Y8G("ngIf","failed"===o.status),t.R7$(),t.Y8G("ngIf","success"===o.status),t.R7$(),t.Y8G("ngIf","success"===o.status&&o.outputUrl),t.R7$(3),t.Y8G("ngIf","downloading"===o.status)}}const Jt=[{path:"",component:(()=>{var i;class n{constructor(e,s,r){this.api=e,this.storage=s,this.toastController=r,this.faces=[],this.targets=[],this.tasks=[],this.faceEnhance=!1,this.isAutomationEnabled=!0}ngOnInit(){var e=this;return(0,f.A)(function*(){const s=yield e.storage.getAll("faces"),r=yield e.storage.getAll("targets");e.tasks=yield e.storage.getAll("tasks"),e.faces=s.map(a=>({...a,localUrl:a.blob?URL.createObjectURL(a.blob):a.localUrl})),e.targets=r.map(a=>({...a,localUrl:a.blob?URL.createObjectURL(a.blob):a.localUrl})),e.restartPolling()})()}handleFileSelect(e,s){var r=this;return(0,f.A)(function*(){const a=e.target.files;for(let c of a){const u={id:crypto.randomUUID(),localUrl:URL.createObjectURL(c),blob:c,type:r.getMediaType(c.type),status:"pending",f_suffix:c.name.split(".").pop()};"faces"===s?r.faces.push(u):r.targets.push(u),r.uploadFile(u,c,s)}})()}uploadFile(e,s,r){var a=this;return(0,f.A)(function*(){try{e.status="uploading";const c=yield a.api.getSignedUrl(e.f_suffix),{put:l,get:u}=c.data.oss_signed_urls[0];yield a.api.uploadToOss(l,s,s.type),e.remoteGetUrl=u,e.status="success",yield a.storage.set(r,e.id,e),a.autoStartProcessing()}catch{e.status="failed",yield a.storage.set(r,e.id,e)}})()}autoStartProcessing(){this.targets.filter(e=>"success"===e.status).forEach(e=>{this.faces.filter(s=>"success"===s.status).forEach(s=>{this.tasks.some(a=>a.faceId===s.id&&a.targetId===e.id)||this.createTask(s,e)})})}startSwapProcess(){this.targets.forEach(e=>{this.faces.forEach(s=>{e.remoteGetUrl&&s.remoteGetUrl&&this.createTask(s,e)})})}createTask(e,s){var r=this;return(0,f.A)(function*(){const a=function q(i,n,o){return!B.randomUUID||n||i?Z(i,n,o):B.randomUUID()}(),c=crypto.randomUUID(),l={id:a,faceId:e.id,targetId:s.id,faceUrl:e.remoteGetUrl,targetUrl:s.remoteGetUrl,type:s.type,status:"waiting",authToken:c};r.tasks.push(l);try{const u=yield r.api.initSwap(s.type,e.remoteGetUrl,s.remoteGetUrl,c,r.faceEnhance);if(1e5!==u.code)throw new Error(u.message);l.predictionId=u.data.prediction_id||u.data.request_id,r.saveAndPoll(l)}catch(u){console.error("Swap Initialization Failed:",u),l.status="failed",r.storage.set("tasks",l.id,l)}})()}saveAndPoll(e){this.storage.set("tasks",e.id,e),this.api.pollStatus(e.type,e.predictionId,e.authToken).pipe(function it(i,n=!1){return(0,et.N)((o,e)=>{let s=0;o.subscribe((0,nt._)(e,r=>{const a=i(r,s++);(a||n)&&e.next(r),!a&&e.complete()}))})}(s=>"waiting"===s.data.status||0===s.data.status||"processing"===s.data.status,!0)).subscribe({next:s=>{"success"===s.data.status||s.data.result_img_url?(e.status="success",e.outputUrl=s.data.output||s.data.result_img_url,this.storage.set("tasks",e.id,e),this.isAutomationEnabled&&(console.log("Auto-downloading result for task:",e.id),this.directDownload(e))):"failed"===s.data.status&&(e.status="failed",this.storage.set("tasks",e.id,e))},error:s=>{console.error("Polling Error:",s),e.status="failed",this.storage.set("tasks",e.id,e)}})}restartPolling(){this.tasks.filter(e=>"waiting"===e.status&&e.predictionId).forEach(e=>this.saveAndPoll(e))}getMediaType(e){return e.includes("video")?"video":e.includes("gif")?"gif":"image"}removeMedia(e,s){var r=this;return(0,f.A)(function*(){yield r.storage.delete(s,e),"faces"===s?r.faces=r.faces.filter(c=>c.id!==e):r.targets=r.targets.filter(c=>c.id!==e);const a=r.tasks.filter(c=>"faces"===s?c.faceId===e:c.targetId===e);for(let c of a)yield r.storage.delete("tasks",c.id);r.tasks=r.tasks.filter(c=>"faces"===s?c.faceId!==e:c.targetId!==e)})()}directDownload(e){var s=this;return(0,f.A)(function*(){if(!e.outputUrl)return void s.presentToast("Output URL available nahi hai.","danger");const r=e.status;e.status="downloading";try{const a="image"===e.type?"png":"gif"===e.type?"gif":"mp4",c=`success_${Date.now()}.${a}`,l=yield fetch(e.outputUrl);if(!l.ok)throw new Error("Download failed");const u=yield l.blob(),m=window.URL.createObjectURL(u),y=document.createElement("a");y.href=m,y.download=c,document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(m),e.status="success",s.presentToast("Download completed!","success")}catch(a){console.error(a),e.status=r,s.presentToast("Download fail ho gaya.","danger")}yield s.storage.set("tasks",e.id,e)})()}presentToast(e){var s=this;return(0,f.A)(function*(r,a="medium"){(yield s.toastController.create({message:r,duration:3e3,color:a})).present()}).apply(this,arguments)}openUrl(e){console.log(this.tasks),window.open(e,"_blank")}deleteSingleTask(e){var s=this;return(0,f.A)(function*(){s.tasks=s.tasks.filter(r=>r.id!==e),yield s.storage.delete("tasks",e)})()}clearAllTasks(){var e=this;return(0,f.A)(function*(){confirm("Kya aap saare tasks aur target media delete karna chahte hain?")&&(e.tasks=[],e.targets=[],yield e.storage.clearStore("tasks"),yield e.storage.clearStore("targets"))})()}downloadAllTasks(){var e=this;return(0,f.A)(function*(){const s=e.tasks.filter(r=>"success"===r.status&&r.outputUrl);if(0!==s.length){e.presentToast(`${s.length} files download ho rahi hain...`,"primary");for(const r of s)yield e.directDownload(r),yield new Promise(a=>setTimeout(a,500))}else e.presentToast("Download karne ke liye koi successful task nahi hai.","warning")})()}isAllProcessing(){return 0===this.faces.length||0===this.targets.length||this.tasks.length>=this.faces.length*this.targets.length}retryTask(e){var s=this;return(0,f.A)(function*(){e.status="waiting",e.predictionId=void 0;try{s.presentToast("Retrying task...","primary");const r=yield s.api.initSwap(e.type,e.faceUrl,e.targetUrl,e.authToken,s.faceEnhance);if(1e5!==r.code)throw new Error("API Error");e.predictionId=r.data.prediction_id,s.saveAndPoll(e)}catch{e.status="failed",s.presentToast("Retry failed again.","danger")}yield s.storage.set("tasks",e.id,e)})()}static#t=i=()=>(this.\u0275fac=function(s){return new(s||n)(t.rXU(_t),t.rXU(Mt),t.rXU(p.K_))},this.\u0275cmp=t.VBU({type:n,selectors:[["app-home"]],standalone:!1,decls:49,vars:11,consts:[["color","primary"],["lines","inset"],["name","sparkles-outline","slot","start","color","primary"],["slot","end",3,"ngModelChange","ngModel"],["lines","none"],["name","flash-outline","slot","start","color","success"],[1,"ion-padding"],["type","file","multiple","","id","faceInput","hidden","",3,"change"],["onclick","document.getElementById('faceInput').click()"],["size","3",4,"ngFor","ngForOf"],["type","file","multiple","","id","targetInput","hidden","",3,"change"],["color","secondary","onclick","document.getElementById('targetInput').click()"],["name","cloud-upload-outline","slot","start"],["size","auto",4,"ngFor","ngForOf"],["expand","block",3,"click","disabled"],[4,"ngIf"],[1,"results-header-container"],[1,"results-title"],[1,"results-actions"],["fill","solid","size","small","color","primary",3,"click",4,"ngIf"],["fill","clear","color","danger","size","small",3,"click",4,"ngIf"],[4,"ngFor","ngForOf"],["size","3"],[1,"media-box"],["color","danger","fill","clear",1,"delete-btn",3,"click"],["name","close-circle"],[3,"src"],["class","success-overlay",4,"ngIf"],["class","abs-center",4,"ngIf"],[1,"success-overlay"],["name","checkmark-circle","color","success"],[1,"abs-center"],["size","auto"],["fill","clear",1,"delete-btn",3,"click"],[3,"src",4,"ngIf"],["muted","",3,"src",4,"ngIf"],["class","abs-center","color","light",4,"ngIf"],["muted","",3,"src"],["color","light",1,"abs-center"],["fill","solid","size","small","color","primary",3,"click"],["name","cloud-download-outline","slot","start"],["fill","clear","color","danger","size","small",3,"click"],["name","trash-bin-outline"],["slot","start"],[3,"color"],["slot","end",1,"task-actions"],["fill","clear","color","warning",3,"click",4,"ngIf"],["fill","clear",3,"click",4,"ngIf"],["fill","clear","color","secondary",3,"click",4,"ngIf"],["fill","clear","color","danger",3,"click"],["name","trash-outline","slot","icon-only"],["name","crescent",4,"ngIf"],["fill","clear","color","warning",3,"click"],["name","sparkles-outline","slot","icon-only"],["fill","clear",3,"click"],["name","download-outline","slot","icon-only"],["fill","clear","color","secondary",3,"click"],["name","open-outline","slot","icon-only"],["name","crescent"]],template:function(s,r){1&s&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),t.EFF(3,"AI Face Swap"),t.k0s()()(),t.j41(4,"ion-item",1),t.nrm(5,"ion-icon",2),t.j41(6,"ion-label")(7,"h2"),t.EFF(8,"Face Enhance"),t.k0s(),t.j41(9,"p"),t.EFF(10,"Improve output face quality (Takes more time)"),t.k0s()(),t.j41(11,"ion-toggle",3),t.mxI("ngModelChange",function(c){return t.DH7(r.faceEnhance,c)||(r.faceEnhance=c),c}),t.k0s()(),t.j41(12,"ion-item",4),t.nrm(13,"ion-icon",5),t.j41(14,"ion-label"),t.EFF(15,"Auto-Process & Download"),t.k0s(),t.j41(16,"ion-toggle",3),t.mxI("ngModelChange",function(c){return t.DH7(r.isAutomationEnabled,c)||(r.isAutomationEnabled=c),c}),t.k0s()(),t.j41(17,"ion-content")(18,"ion-list-header"),t.EFF(19,"Step 1: Choose Faces"),t.k0s(),t.j41(20,"div",6)(21,"input",7),t.bIt("change",function(c){return r.handleFileSelect(c,"faces")}),t.k0s(),t.j41(22,"ion-button",8),t.EFF(23,"Upload Faces"),t.k0s(),t.j41(24,"ion-grid")(25,"ion-row"),t.DNE(26,Ft,7,5,"ion-col",9),t.k0s()()(),t.j41(27,"ion-list-header"),t.EFF(28,"Step 2: Choose Target Videos/Images"),t.k0s(),t.j41(29,"div",6)(30,"input",10),t.bIt("change",function(c){return r.handleFileSelect(c,"targets")}),t.k0s(),t.j41(31,"ion-button",11),t.nrm(32,"ion-icon",12),t.EFF(33," Upload Targets "),t.k0s(),t.j41(34,"ion-grid")(35,"ion-row"),t.DNE(36,Gt,8,6,"ion-col",13),t.k0s()()(),t.j41(37,"ion-button",14),t.bIt("click",function(){return r.startSwapProcess()}),t.DNE(38,$t,2,1,"span",15)(39,Ht,2,0,"span",15)(40,Vt,2,0,"span",15),t.k0s(),t.j41(41,"div",16)(42,"ion-label",17),t.EFF(43,"Results"),t.k0s(),t.j41(44,"div",18),t.DNE(45,Lt,3,0,"ion-button",19)(46,Yt,2,0,"ion-button",20),t.k0s()(),t.j41(47,"ion-list"),t.DNE(48,Kt,18,10,"ion-item",21),t.k0s()()),2&s&&(t.R7$(11),t.R50("ngModel",r.faceEnhance),t.R7$(5),t.R50("ngModel",r.isAutomationEnabled),t.R7$(10),t.Y8G("ngForOf",r.faces),t.R7$(10),t.Y8G("ngForOf",r.targets),t.R7$(),t.Y8G("disabled",r.isAllProcessing()),t.R7$(),t.Y8G("ngIf",!r.isAllProcessing()),t.R7$(),t.Y8G("ngIf",r.isAllProcessing()&&r.tasks.length>0),t.R7$(),t.Y8G("ngIf",0===r.faces.length||0===r.targets.length),t.R7$(5),t.Y8G("ngIf",r.tasks.length>0),t.R7$(),t.Y8G("ngIf",r.tasks.length>0),t.R7$(2),t.Y8G("ngForOf",r.tasks))},dependencies:[k.Sq,k.bT,x.BC,x.vS,p.In,p.Jm,p.hU,p.W9,p.lO,p.eU,p.iq,p.uz,p.he,p.nf,p.AF,p.ln,p.w2,p.Zx,p.BC,p.BY,p.ai,p.hB,k.Pc],styles:["ion-col[_ngcontent-%COMP%]{display:flex!important;justify-content:flex-start!important;align-items:center!important;padding:15px!important;min-width:120px!important;max-width:120px!important}.media-box[_ngcontent-%COMP%]{position:relative!important;width:100px!important;height:100px!important;border-radius:12px!important;border:3px solid transparent!important;background:#1e1e1e;display:block!important}.media-box.upload-success[_ngcontent-%COMP%]{border-color:#2dd36f!important}.media-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .media-box[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%!important;height:100%!important;object-fit:cover!important;display:block!important}.delete-btn[_ngcontent-%COMP%]{position:absolute!important;top:-10px!important;right:-10px!important;margin:0!important;z-index:100!important;height:28px!important;width:28px!important;--padding-start: 0 !important;--padding-end: 0 !important}.delete-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:28px!important;color:#eb445a!important;background:#fff!important;border-radius:50%!important;box-shadow:0 2px 5px #00000080}.success-overlay[_ngcontent-%COMP%]{position:absolute!important;top:5px!important;left:5px!important;z-index:50!important;background:#fff!important;border-radius:50%!important;height:20px!important;width:20px!important;display:flex!important;align-items:center!important;justify-content:center!important}.success-overlay[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px!important}ion-col[_ngcontent-%COMP%]{padding:5px!important;flex:0 0 auto!important;width:auto!important}.media-box[_ngcontent-%COMP%]{position:relative!important;width:90px!important;height:90px!important;margin:5px}.media-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%], .media-box[_ngcontent-%COMP%]   video[_ngcontent-%COMP%]{width:100%!important;height:100%!important;object-fit:cover;border-radius:8px}.delete-btn[_ngcontent-%COMP%]{position:absolute!important;top:-8px!important;right:-8px!important;margin:0!important;z-index:100!important;--padding-start: 0;--padding-end: 0;width:24px;height:24px}.delete-btn[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px;background:#fff;border-radius:50%}.task-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px}.task-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 8px;--padding-end: 8px;height:32px}ion-thumbnail[_ngcontent-%COMP%]{--border-radius: 4px;border:1px solid #444}.results-header-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px 16px;background:#f8f9fa;border-bottom:1px solid #ddd;margin-top:10px}.results-header-container[_ngcontent-%COMP%]   .results-title[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--ion-color-dark)}.results-header-container[_ngcontent-%COMP%]   .results-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.results-header-container[_ngcontent-%COMP%]   .results-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0;height:32px;font-size:12px;--border-radius: 6px}@media (prefers-color-scheme: dark){.results-header-container[_ngcontent-%COMP%]{background:#1e1e1e;border-bottom:1px solid #333}.results-header-container[_ngcontent-%COMP%]   .results-title[_ngcontent-%COMP%]{color:#fff}}"]}))}return i(),n})()}];let Qt=(()=>{var i;class n{static#t=i=()=>(this.\u0275fac=function(s){return new(s||n)},this.\u0275mod=t.$C({type:n}),this.\u0275inj=d.G2t({imports:[O.iI.forChild(Jt),O.iI]}))}return i(),n})(),Zt=(()=>{var i;class n{static#t=i=()=>(this.\u0275fac=function(s){return new(s||n)},this.\u0275mod=t.$C({type:n}),this.\u0275inj=d.G2t({imports:[k.MD,x.YN,p.bv,Qt]}))}return i(),n})()}}]);